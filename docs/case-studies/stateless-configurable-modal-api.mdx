# Stateless Edit Product Modal API

This page documents the public API of `EditProductModal` as consumed in this portfolio demo.

## Component

```tsx
import EditProductModal from '@site/src/components/edit-product-modal/components/edit-product-modal';
```

`EditProductModal` is stateless regarding remote data fetching.  
The consumer provides initial state + `skuVariants`, and injects behavior/UI through render props.

## Architectural Rationale

### Problem To Solve

In product contexts, a single modal shape usually needs multiple behavioral variants:

- Different notification policies (`sold out`, `low stock`, campaign copy)
- Different CTA rules (disable vs notify-me vs alternate flow)
- Different header/media compositions by surface or experiment

### Approach Taken

This implementation exposes:

- composable partial UI components/utilities for consumers
- render props with rich derived args for runtime composition

instead of only fixed slots with opaque internals.

### Why This Is A Sound Tradeoff

- Higher extensibility without forking modal internals
- Reuse of domain-derived state (`currentMatchingSku`, maps, indexes) at integration points
- Better fit for experimentation and business-specific behavior

Tradeoff:

- API surface is larger and requires stronger documentation discipline (this page exists for that reason).

## Core Props

### Required

| Prop | Type | Purpose |
| --- | --- | --- |
| `mainHeading` | `string` | Main heading shown in modal header. |
| `productName` | `string` | Product label used in UI and image alt fallback. |
| `initialImageUrl` | `string \| null` | Initial image while data state is being resolved. |
| `initialColorCode` | `string \| null` | Initial selected color code (must match `skuVariants.colors`). |
| `initialSize` | `string \| null` | Initial selected size (must match `skuVariants.sizes`). |
| `onDismiss` | `({ event, currentMatchingSku }) => void` | Close handler; receives the currently matched SKU in ready state. |

### Optional Base Data

| Prop | Type | Default | Purpose |
| --- | --- | --- | --- |
| `initialListPrice` | `string \| null` | `null` | Header fallback list price during loading/initial state. |
| `initialSalePrice` | `string \| null` | `null` | Header fallback sale price during loading/initial state. |
| `skuVariants` | `SkuVariants \| null` | `{}` | Source of colors, sizes, SKU combinations, image groups. |
| `enableStickySecondChildFooter` | `boolean` | `true` | Controls sticky behavior of right-panel footer frame. |

## Data Types

```ts
type SkuVariants = {
  sizes?: { size: string; available?: boolean }[];
  colors?: { colorCode: string; displayName?: string; available?: boolean }[];
  availableSkus?: {
    id?: string;
    colorCode: string;
    size: string;
    listPrice?: string;
    salePrice?: string;
    available?: boolean;
  }[];
  imagesByColorCode?: Record<string, string[]>;
};
```

## Render Prop API

### Loading-phase slots

| Render prop | Signature | Purpose |
| --- | --- | --- |
| `renderLoadingSecondChild` | `() => ReactNode` | Full override of lower section (*mobile-ish*) or right section (*desktop-ish*), i.e. loading `secondChild` area. |
| `renderLoadingSecondChildHeader` | `() => ReactNode` | Override the loading header in lower section (*mobile-ish*) or right section header (*desktop-ish*), i.e. `secondChild` header. |

### Ready-phase structure slots

| Render prop | Signature | Purpose |
| --- | --- | --- |
| `renderFirstChild` | `(args: { currentColorIndex; prevColorIndex; currentSizeIndex; prevSizeIndex; setCurrentColorIndex; setCurrentSizeIndex; availableSkus; colors; sizes; colorToSizeMap; sizeToColorMap; imagesByColorCode; currentImagesUrls; currentColorDetails; currentSizeDetails }) => ReactNode` | Full override of top section (*mobile-ish*) or left section (*desktop-ish*), i.e. `firstChild` area (typically media). |
| `renderSecondChild` | `(args: { currentColorIndex; prevColorIndex; currentSizeIndex; prevSizeIndex; setCurrentColorIndex; setCurrentSizeIndex; availableSkus; colors; sizes; colorToSizeMap; sizeToColorMap; imagesByColorCode; currentImagesUrls; currentColorDetails; currentSizeDetails }) => ReactNode` | Full override of lower section (*mobile-ish*) or right section (*desktop-ish*), i.e. `secondChild` area. Bypasses default composition. |
| `renderSecondChildHeader` | `(args: { currentColorIndex; prevColorIndex; currentSizeIndex; prevSizeIndex; setCurrentColorIndex; setCurrentSizeIndex; availableSkus; colors; sizes; colorToSizeMap; sizeToColorMap; imagesByColorCode; currentImagesUrls; currentColorDetails; currentSizeDetails; currentMatchingSku }) => ReactNode` | Override the header in lower section (*mobile-ish*) or right section header (*desktop-ish*), i.e. `secondChild` header. |
| `renderAttrsSelectors` | `(args: { currentColorIndex; prevColorIndex; currentSizeIndex; prevSizeIndex; setCurrentColorIndex; setCurrentSizeIndex; availableSkus; colors; sizes; colorToSizeMap; sizeToColorMap; imagesByColorCode; currentImagesUrls; currentColorDetails; currentSizeDetails; currentMatchingSku }) => ReactNode` | Override selector block (color/size controls). |
| `renderAfterAttrsSelectors` | `(args: { currentColorIndex; prevColorIndex; currentSizeIndex; prevSizeIndex; setCurrentColorIndex; setCurrentSizeIndex; availableSkus; colors; sizes; colorToSizeMap; sizeToColorMap; imagesByColorCode; currentImagesUrls; currentColorDetails; currentSizeDetails }) => ReactNode` | Insert content after selectors in lower section (*mobile-ish*) or right section (*desktop-ish*), before `secondChild` sticky footer. |

### Ready-phase interaction/content slots

| Render prop | Signature | Purpose |
| --- | --- | --- |
| `renderNotifications` | `(args: { isCurrentSkuAvailable; currentMatchingSkuId; currentColorDetails; currentColorIndex; currentSizeDetails; currentSizeIndex; prevColorIndex; prevSizeIndex; availableSkus }) => ReactNode` | Show status messages in lower section footer (*mobile-ish*) or right section footer (*desktop-ish*), e.g. `sold out` / `low stock`. |
| `renderPrimaryCta` | `(args: { isCurrentSkuAvailable; currentMatchingSkuId; currentColorDetails; currentColorIndex; currentSizeDetails; currentSizeIndex; prevColorIndex; prevSizeIndex; currentMatchingSku }) => ReactNode` | Render primary action in lower section footer (*mobile-ish*) or right section footer (*desktop-ish*). |
| `renderSecondaryCta` | `(args: { isCurrentSkuAvailable; currentMatchingSkuId; currentColorDetails; currentColorIndex; currentSizeDetails; currentSizeIndex; prevColorIndex; prevSizeIndex; currentMatchingSku }) => ReactNode` | Render secondary action in lower section footer (*mobile-ish*) or right section footer (*desktop-ish*). |
| `renderHeading` | `() => ReactNode` | Replace default heading component in ready header. |
| `renderAfterHeading` | `() => ReactNode` | Inject badge/tag/meta under heading in lower section header (*mobile-ish*) or right section header (*desktop-ish*). |
| `renderPrice` | `(args: { listPrice?: string \| null; salePrice?: string \| null }) => ReactNode` | Replace default price renderer in lower section header (*mobile-ish*) or right section header (*desktop-ish*). |

## Dismiss Semantics

- In loading mode, `onDismiss` receives `currentMatchingSku: null`.
- In ready mode, `onDismiss` receives the currently matched SKU object (or empty object when unmatched).

## Loading vs Ready Trigger

The component renders loading experience when any of these is missing:

- `initialImageUrl`
- `initialColorCode`
- `initialSize`
- `skuVariants`
- resolved internal color/size indexes

## Default Composition (if no overrides)

- `firstChild`: product images carousel.
- `secondChild` header: heading + price.
- `secondChild` body: default color and size selectors.
- `secondChild` sticky footer: notifications and CTAs only if provided.

Layout note:
- *mobile-ish*: `firstChild` behaves like a top content area.
- *desktop-ish*: `firstChild` behaves like a left content area.

## Helper UI Exports Used By Consumers

For composing render props, these are available from:

```ts
import {
  EditProductPrimaryButton,
  EditProductSecondaryCta,
  EditProductHeader,
  EditProductHeading,
  EditProductPrice,
  EditProductImages,
  EditProductErrorNotification,
  EditProductWarningNotification,
  EditProductColorSelector,
  EditProductSizeSelector,
  EditProductAttrsSelectors,
  EditProductScrollableFrame,
  EditProductStickyFrame,
} from '@site/src/components/edit-product-modal/components/partials';
```

## Minimal Usage Example

```tsx
<EditProductModal
  mainHeading="BuyMeNot Sneakers"
  productName="BuyMeNot Sneakers"
  initialImageUrl={item.imageUrl}
  initialColorCode={item.colorCode}
  initialSize={item.size}
  skuVariants={data.skuVariants}
  onDismiss={({ currentMatchingSku }) => {
    // handle close
  }}
/>
```
